'use strict';

const VitePlugin = require('@unocss/vite');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e["default"] : e; }

const VitePlugin__default = /*#__PURE__*/_interopDefaultLegacy(VitePlugin);

function UnoCSSAstroIntegration(options = {}, defaults) {
  const {
    injectEntry = true,
    injectReset: includeReset = true
  } = options;
  return {
    name: "unocss",
    hooks: {
      "astro:config:setup": async ({ config, injectScript }) => {
        var _a;
        (_a = config.vite).plugins || (_a.plugins = []);
        config.vite.plugins.push(...VitePlugin__default(options, defaults));
        const injects = [];
        if (includeReset) {
          const resetPath = typeof includeReset === "string" ? includeReset : "@unocss/reset/tailwind.css";
          injects.push(`import "${resetPath}"`);
        }
        if (injectEntry) {
          injects.push(typeof injectEntry === "string" ? injectEntry : 'import "uno.css"');
        }
        if (injects?.length)
          injectScript("page-ssr", injects.join("\n"));
      }
    }
  };
}

module.exports = UnoCSSAstroIntegration;
