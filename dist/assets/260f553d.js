import{a as x,f as D,H as m,ad as b,l as h,j as o,u as a,o as N,i as t,af as d,ae as l,ag as B,e as P,n as k,ai as I,aj as K,aK as _}from "./315a852e.js";import{u as M,M as c}from "./index.148f4d09.js";function R(p, n){return x.patch(`/api/user/${p}/password`,n)}const V={style:{display:"flex","justify-content":"center"}},S=D({__name:"index",setup(p){const n=m(null),i=m(null),s=b({password:"",new_password:"",confirm_password:""});function v(r, e){return!!s.new_password&&s.new_password.startsWith(e)&&s.new_password.length>=e.length}function g(r, e){return e===s.new_password}const F={password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}],new_password:[{required:!0,message:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801"}],confirm_password:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u65B0\u5BC6\u7801",trigger:["input","blur"]},{validator:v,message:"\u4E24\u6B21\u65B0\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4",trigger:"input"},{validator:g,message:"\u4E24\u6B21\u65B0\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4",trigger:["blur","password-input"]}]};function C(){var r;s.confirm_password&&((r=i.value)==null||r.validate({trigger:"password-input"}))}const y=M();function E(r){var e;r.preventDefault(),(e=n.value)==null||e.validate(u=>{var w;u?(console.log(u),(w=c)==null||w.error("\u9A8C\u8BC1\u5931\u8D25")):R(y.account,s).then(()=>{var f;return(f=c)==null?void 0:f.success("\u5BC6\u7801\u4FEE\u6539\u6210\u529F")})})}return(r, e)=>(N(),h(a(K),{ref_key:"formRef",ref:n,model:s,rules:F,class:"max-w-640px"},{default:o(()=>[t(a(l),{path:"password",label:"\u5F53\u524D\u5BC6\u7801"},{default:o(()=>[t(a(d),{value:s.password,"onUpdate:value":e[0]||(e[0]= u=>s.password=u),type:"password"},null,8,["value"])]),_:1}),t(a(l),{path:"new_password",label:"\u65B0\u5BC6\u7801"},{default:o(()=>[t(a(d),{value:s.new_password,"onUpdate:value":e[1]||(e[1]= u=>s.new_password=u),type:"password",onInput:C,onKeydown:e[2]||(e[2]=B(_(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(a(l),{ref_key:"rPasswordFormItemRef",ref:i,first:"",path:"confirm_password",label:"\u91CD\u590D\u65B0\u5BC6\u7801"},{default:o(()=>[t(a(d),{value:s.confirm_password,"onUpdate:value":e[3]||(e[3]= u=>s.confirm_password=u),disabled:!s.new_password,type:"password",onKeydown:e[4]||(e[4]=B(_(()=>{},["prevent"]),["enter"]))},null,8,["value","disabled"])]),_:1},512),P("div",V,[t(a(I),{round:"",type:"primary",onClick:E},{default:o(()=>[k(" \u4FEE\u6539 ")]),_:1})])]),_:1},8,["model"]))}});export{S as default};
