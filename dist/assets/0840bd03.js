import{j as S,k as j,l as I}from "./3a8f2c57.js";import{f as C,H as f,h as V,o as y,l as b,j as u,i as l,u as t,aH as w,at as E,ak as F,ad as M,A as P,ar as $,aj as q,af as h,ae as v,n as x,e as c,D,ai as N,N as J,aI as H,aJ as O}from "./315a852e.js";import{E as T,M as B}from "./index.148f4d09.js";const z=C({__name:"KVEdit",props:{modelValue:null},emits:["update:modelValue"],setup(k, {emit:n}){const m=k,p=f([]);for(const e in m.modelValue)p.value.push({key:e,value:m.modelValue[e]});const i=V({get(){return p.value},set(e){p.value=e;let d={};for(let r of e)d[r.key]=r.value;n("update:modelValue",d)}});return(e, d)=>(y(),b(t(F),null,{default:u(()=>[l(t(E),{value:t(i),"onUpdate:value":d[0]||(d[0]= r=>w(i)?i.value=r:null),preset:"pair","key-placeholder":"name","value-placeholder":"value"},null,8,["value"])]),_:1}))}}),G={class:"flex-1 text-18px m-a"},K={class:"flex justify-end"},Q={class:"m-a"},W={class:"flex justify-end m-t-12px"},te=C({__name:"Action",props:{id:{type:Number,required:!1}},setup(k){const n=k,m=f(),p=f(null),i=f(!1),e=M({name:"",label_set_list:[{}],severity_set:[],comment:""}),d={name:{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:"blur"},base_url:{required:!0,message:"\u8BF7\u8F93\u5165BaseUrl",trigger:"blur"}},r=f(!1);function U(o){i.value=!0,m.value=o}n.id&&(r.value=!0,S(n.id).then(o=>{const a=o.data;e.name=a.name,e.label_set_list=a.label_set_list,e.severity_set=a.severity_set,e.comment=a.comment,r.value=!1}));const _=V({get(){return e.label_set_list[m.value]},set(o){e.label_set_list[m.value]=o}}),A=P();function L(){var o;(o=p.value)==null||o.validate(a=>{var s;a?(console.log("errors"),(s=B)==null||s.error("\u9A8C\u8BC1\u5931\u8D25")):(n.id?j(n.id,e):I(e)).then(X=>{var g;(g=B)==null||g.success("success"),A.push({name:"FakePrometheusDatasourceList"})})})}return(o, a)=>(y(),b(t(F),{title:`${n.id?"\u7F16\u8F91":"\u6DFB\u52A0"}Prometheus\u6570\u636E\u6E90`},{default:u(()=>[r.value?(y(),b(t($),{key:0,text:"",repeat:12})):(y(),b(t(q),{key:1,ref_key:"formRef",ref:p,model:e,"label-placement":"left","label-width":100,rules:d,class:"max-w-95%"},{default:u(()=>[l(t(v),{label:"\u540D\u79F0:",path:"name"},{default:u(()=>[l(t(h),{value:e.name,"onUpdate:value":a[0]||(a[0]= s=>e.name=s)},null,8,["value"])]),_:1}),l(t(v),{label:"LabelSetList:",path:"label_set_list"},{default:u(()=>[l(t(E),{value:e.label_set_list,"onUpdate:value":a[1]||(a[1]= s=>e.label_set_list=s),"on-create":()=>({})},{"create-button-default":u(()=>[x(" \u6DFB\u52A0 ")]),default:u(({index:s})=>[c("pre",G,D(JSON.stringify(e.label_set_list[s])),1),l(t(N),{text:"",onClick: R=>U(s),class:"text-18px"},{default:u(()=>[l(t(J),null,{default:u(()=>[l(T)]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["value","on-create"])]),_:1}),l(t(v),{label:"SeverityList:",path:"severity_list"},{default:u(()=>[l(t(H),{value:e.severity_set,"onUpdate:value":a[2]||(a[2]= s=>e.severity_set=s)},null,8,["value"])]),_:1}),l(t(v),{label:"\u5907\u6CE8: ",path:"comment"},{default:u(()=>[l(t(h),{value:e.comment,"onUpdate:value":a[3]||(a[3]= s=>e.comment=s),type:"textarea",autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1}),c("div",K,[l(t(N),{onClick:L,type:"primary"},{default:u(()=>[x("\u63D0\u4EA4")]),_:1})]),l(t(O),{show:i.value},{default:u(()=>[l(t(F),{class:"w-800px",bordered:!1},{header:u(()=>[c("pre",Q,D(JSON.stringify(t(_))),1)]),default:u(()=>[l(z,{modelValue:t(_),"onUpdate:modelValue":a[4]||(a[4]= s=>w(_)?_.value=s:null)},null,8,["modelValue"]),c("div",W,[l(t(N),{onClick:a[5]||(a[5]= s=>i.value=!1),type:"primary"},{default:u(()=>[x("\u5B8C\u6210")]),_:1})])]),_:1})]),_:1},8,["show"])]),_:1},8,["model"]))]),_:1},8,["title"]))}});export{te as default};
