import{d as J,e as I,f as L}from "./2d7efc63.js";import{s as M}from "./ad89c71c.js";import{f as R,H as i,ad as W,A as P,l as m,j as s,u as l,o as d,ar as G,aj as H,i as t,af as v,ae as k,as as _,n as g,at as h,e as b,ap as N,ai as T,ak as $}from "./315a852e.js";import{M as E}from "./index.148f4d09.js";const z={class:"flex"},K=b("div",{class:"m-x-8px h-34px lh-34px"}," : ",-1),Q={class:"flex"},X=b("div",{class:"m-x-8px h-34px lh-34px"}," : ",-1),Y={class:"flex"},Z=b("div",{class:"m-x-8px h-34px lh-34px"}," : ",-1),ee={class:"flex justify-end"},se=R({__name:"Action",props:{id:{type:Number,required:!1}},setup(S){const w=S,A=i(null),u=W({name:"",username:"",email:"",mobile:"",wecom:"",dingtalk:"",lark:""}),V={username:{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"},email:{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1",trigger:"blur"},name:{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"},mobile:{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"}},U=i(!0),D=i(!0),C=i(!0);function F(){return{name:"",value:""}}const y=i();M().then(r=>{y.value=r.data.filter(a=>a.type==="wecom").map(a=>({label:a.index,value:a.index}))});const p=i([]),c=i([]),f=i([]),B=i(!1);w.id&&(B.value=!0,J(w.id).then(r=>{const a=r.data;u.username=a.username,u.name=a.name,u.email=a.email,u.mobile=a.mobile,u.wecom=a.wecom,u.dingtalk=a.dingtalk,u.lark=a.lark;try{let e=JSON.parse(u.wecom),x=JSON.parse(u.dingtalk),o=JSON.parse(u.lark);for(let n in e)p.value.push({name:n,value:e[n]});for(let n in x)c.value.push({name:n,value:x[n]});for(let n in o)f.value.push({name:n,value:o[n]})}catch(e){console.log(e)}B.value=!1}));function q(r){let a={};for(let e of r)a[e.name]=e.value;return Object.keys(a).length>0?JSON.stringify(a):""}const O=P();function j(){var r;(r=A.value)==null||r.validate(a=>{var e;a?(console.log("errors"),(e=E)==null||e.error("\u9A8C\u8BC1\u5931\u8D25")):(U.value||(u.wecom=q(p.value)),(w.id?I(w.id,u):L(u)).then(o=>{var n;(n=E)==null||n.success("success"),O.push({name:"ContactList"})}))})}return(r, a)=>(d(),m(l($),{title:`${w.id?"\u7F16\u8F91":"\u6DFB\u52A0"}\u901A\u8BAF\u5F55`},{default:s(()=>[B.value?(d(),m(l(G),{key:0,text:"",repeat:8})):(d(),m(l(H),{key:1,ref_key:"formRef",ref:A,model:u,"label-placement":"left","label-width":160,rules:V,style:{maxWidth:"640px"}},{default:s(()=>[t(l(k),{label:"\u7528\u6237\u540D: ",path:"username"},{default:s(()=>[t(l(v),{value:u.username,"onUpdate:value":a[0]||(a[0]= e=>u.username=e)},null,8,["value"])]),_:1}),t(l(k),{label:"\u59D3\u540D: ",path:"name"},{default:s(()=>[t(l(v),{value:u.name,"onUpdate:value":a[1]||(a[1]= e=>u.name=e)},null,8,["value"])]),_:1}),t(l(k),{label:"\u90AE\u7BB1: ",path:"email"},{default:s(()=>[t(l(v),{value:u.email,"onUpdate:value":a[2]||(a[2]= e=>u.email=e)},null,8,["value"])]),_:1}),t(l(k),{label:"\u624B\u673A: ",path:"mobile"},{default:s(()=>[t(l(v),{value:u.mobile,"onUpdate:value":a[3]||(a[3]= e=>u.mobile=e)},null,8,["value"])]),_:1}),t(l(k),{label:"\u4F01\u4E1A\u5FAE\u4FE1: ",path:"wecom",class:"wecom"},{default:s(()=>[t(l(_),{class:"self-start mb-4px",value:U.value,"onUpdate:value":a[4]||(a[4]= e=>U.value=e)},{checked:s(()=>[g("single")]),unchecked:s(()=>[g("multiple")]),_:1},8,["value"]),U.value?(d(),m(l(v),{key:0,value:u.wecom,"onUpdate:value":a[5]||(a[5]= e=>u.wecom=e)},null,8,["value"])):(d(),m(l(h),{key:1,value:p.value,"onUpdate:value":a[6]||(a[6]= e=>p.value=e),"on-create":F},{default:s(({index:e,value:x})=>[b("div",z,[t(l(N),{value:p.value[e].name,"onUpdate:value": o=>p.value[e].name=o,options:y.value,class:"min-w-240px"},null,8,["value","onUpdate:value","options"]),K,t(l(v),{value:p.value[e].value,"onUpdate:value": o=>p.value[e].value=o,placeholder:"Value"},null,8,["value","onUpdate:value"])])]),_:1},8,["value"]))]),_:1}),t(l(k),{label:"\u9489\u9489\u540D\u79F0: ",path:"wecom",class:"wecom"},{default:s(()=>[t(l(_),{class:"self-start mb-4px",value:D.value,"onUpdate:value":a[7]||(a[7]= e=>D.value=e)},{checked:s(()=>[g("single")]),unchecked:s(()=>[g("multiple")]),_:1},8,["value"]),U.value?(d(),m(l(v),{key:0,value:u.dingtalk,"onUpdate:value":a[8]||(a[8]= e=>u.dingtalk=e)},null,8,["value"])):(d(),m(l(h),{key:1,value:c.value,"onUpdate:value":a[9]||(a[9]= e=>c.value=e),"on-create":F},{default:s(({index:e,value:x})=>[b("div",Q,[t(l(N),{value:c.value[e].name,"onUpdate:value": o=>c.value[e].name=o,options:y.value,class:"min-w-240px"},null,8,["value","onUpdate:value","options"]),X,t(l(v),{value:c.value[e].value,"onUpdate:value": o=>c.value[e].value=o,placeholder:"Value"},null,8,["value","onUpdate:value"])])]),_:1},8,["value"]))]),_:1}),t(l(k),{label:"\u98DE\u4E66\u540D\u79F0: ",path:"wecom",class:"wecom"},{default:s(()=>[t(l(_),{class:"self-start mb-4px",value:C.value,"onUpdate:value":a[10]||(a[10]= e=>C.value=e)},{checked:s(()=>[g("single")]),unchecked:s(()=>[g("multiple")]),_:1},8,["value"]),U.value?(d(),m(l(v),{key:0,value:u.lark,"onUpdate:value":a[11]||(a[11]= e=>u.lark=e)},null,8,["value"])):(d(),m(l(h),{key:1,value:f.value,"onUpdate:value":a[12]||(a[12]= e=>f.value=e),"on-create":F},{default:s(({index:e,value:x})=>[b("div",Y,[t(l(N),{value:f.value[e].name,"onUpdate:value": o=>f.value[e].name=o,options:y.value,class:"min-w-240px"},null,8,["value","onUpdate:value","options"]),Z,t(l(v),{value:f.value[e].value,"onUpdate:value": o=>f.value[e].value=o,placeholder:"Value"},null,8,["value","onUpdate:value"])])]),_:1},8,["value"]))]),_:1}),b("div",ee,[t(l(T),{onClick:j,type:"primary"},{default:s(()=>[g("\u63D0\u4EA4")]),_:1})])]),_:1},8,["model"]))]),_:1},8,["title"]))}});export{se as default};
