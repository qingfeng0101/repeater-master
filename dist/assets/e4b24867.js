import{a as m,f as A,H as d,ad as x,h as E,c as O,i as l,j as n,u as t,G as f,aG as N,ai as g,o as V,N as M,af as b,n as _,am as P,aj as R,ae as w,aL as G,aq as U,aH as $,aM as j,e as q,aJ as K}from "./315a852e.js";import{M as c,S as L}from "./index.148f4d09.js";import{_ as T}from "./d304026b.js";function H(){return m.get("/api/apikey")}function J(s){return m.post("/api/apikey",s)}function Q(s){return m.delete(`/api/apikey/${s}`)}function W(s){return m.patch(`/api/apikey/${s}/refresh`)}const X={class:"flex justify-end"},te=A({__name:"index",setup(s){const i=d(!1),r=x({name:"",expire_delta:1*24*60*60}),y=x({title:"\u540D\u79F0",width:140,filterOptionValue:null,key:"name",filter(e, a){return!!~(a.name||"").indexOf(e.toString())}}),k=E({get(){return r.expire_delta/24/60/60},set(e){r.expire_delta=e*24*60*60}}),D=[y,{title:"\u521B\u5EFA\u65F6\u95F4",key:"created_at",sorter:"default",render(e){return f(N,{time:e.created_at,unix:!0})}},{title:"\u5931\u6548\u65F6\u95F4",key:"updated_at",render(e){return f(N,{time:e.updated_at+e.expire_delta,unix:!0})}},{title:"Key",key:"key"},{title:"\u64CD\u4F5C",key:"actions",width:180,render(e){return[f(g,{size:"small",type:"primary",class:"mr-8px",onClick:()=>S(e)},{default:()=>"\u5C55\u671F"}),f(T,{size:"small",type:"error",onClick:()=>B(e)},{default:()=>"\u5220\u9664"})]}}],o=x({page:1,pageSize:15,showSizePicker:!0,pageSizes:[10,15,25,30,50,100],onChange: e=>{o.page=e},onPageSizeChange: e=>{o.pageSize=e,o.page=1}}),p=d([]),h=d(!1);function v(){h.value=!0,H().then(e=>{p.value=e.data}).finally(()=>h.value=!1)}v();function B(e){Q(e.id).then(()=>{var a;p.value.splice(p.value.indexOf(e),1),(a=c)==null||a.success("success")})}function S(e){W(e.id).then(()=>{var a;(a=c)==null||a.success("success"),v()})}const F=d(null),I={name:{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:"blur"},expire_delta:{type:"number",required:!0,message:"\u8BF7\u8F93\u5165\u6709\u6548\u671F",trigger:"blur"}};function z(){var e;(e=F.value)==null||e.validate(a=>{var u;a?(console.log("errors"),(u=c)==null||u.error("\u9A8C\u8BC1\u5931\u8D25")):J(r).then(Y=>{var C;(C=c)==null||C.success("success"),i.value=!1,v()})})}return(e, a)=>(V(),O("div",null,[l(t(b),{value:y.filterOptionValue,"onUpdate:value":a[0]||(a[0]= u=>y.filterOptionValue=u),placeholder:"\u8FC7\u6EE4",style:{width:"240px",margin:"0 8px 8px 0"}},{suffix:n(()=>[l(t(M),{component:L})]),_:1},8,["value"]),l(t(g),{type:"primary",onClick:a[1]||(a[1]= u=>i.value=!0),class:"mb-8px mr-8px"},{default:n(()=>[_("\u6DFB\u52A0")]),_:1}),l(t(P),{data:p.value,pagination:o,columns:D,"row-key": u=>u.id},null,8,["data","pagination","row-key"]),l(t(K),{show:i.value,"onUpdate:show":a[4]||(a[4]= u=>i.value=u),preset:"card","mask-closable":!1,title:"\u521B\u5EFAAPI Key",style:{width:"680px"}},{default:n(()=>[l(t(R),{ref_key:"formRef",ref:F,model:r,"label-placement":"left","label-width":120,rules:I},{default:n(()=>[l(t(w),{label:"\u540D\u79F0:",path:"name"},{default:n(()=>[l(t(b),{value:r.name,"onUpdate:value":a[2]||(a[2]= u=>r.name=u)},null,8,["value"])]),_:1}),l(t(w),{label:"\u6709\u6548\u671F:",path:"expire_delta"},{default:n(()=>[l(t(G),null,{default:n(()=>[l(t(U),{class:"w-66%",value:t(k),"onUpdate:value":a[3]||(a[3]= u=>$(k)?k.value=u:null),"show-button":!1},null,8,["value"]),l(t(j),null,{default:n(()=>[_("\u5929")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),q("div",X,[l(t(g),{round:"",type:"primary",onClick:z},{default:n(()=>[_(" \u63D0\u4EA4 ")]),_:1})])]),_:1},8,["show"])]))}});export{te as default};
